# Manipulation of Google Docs
Google docs allows for a lot of flexibility in the creation, deletion, and updating of Google docs. The impetus behind this repo is to develop simple code that allows me to produce final documents from a combination of document templates and structured data.

While Google's API provides for the capability of creating docs from scratch the purpose here is a simpler one - alter text in a doc template that already exists.

This is, by far, the fastest method to productivity gains. Creating a doc from scratch in code involves a fair amount of trial and error until you learn the ins and outs of the doc system. Then you effectively code up a template for each table, image, section of text, etc. and build up a full doc from those piecemeal templates. However, in most instances it is much faster to simply create the template manually and replace the text and images as needed.

It is recommended that you read this page before digging into the repo:
https://developers.google.com/docs/api/quickstart/python

The upfront investment of this repo is:
  1) Create a doc template.
     1) Do this via Google docs and their web interface.
  2) Create structured data.
     1) This data is generated by another tool that you are already using. 
  3) Create code is to parse structured data and replace token in template.
     1) Think of this as code to translate from the language of the tool that created the structured data to the tokens in the template.

The daily workflow is:
  1) Provide code from #3 above with structured data.
  2) Share populated doc(s) with others via email address.
     1) This repo includes a tool for automatically sharing the doc(s) with others via email.

## What this repo can do
As of Mar-2023, the repo will allow:
  
  1) you to take an existing doc with tokens in it, 
  2) copy that doc to a folder of your choosing, 
  3) provide a new file name for the file, and 
  4) replace the tokens with text you define in code. 
 
Google's API provides a batchUpdate method which is perfect for executing the token replacement.

Additionally, the repo will allow:
  1) for sharing a file or folder,
  2) finding folders, and
  3) creating folders.

### What is a token?

A token is a string that is highly unlikely to appear naturally in your text. I prefer tokens that begin and end with two percent signs (%%). For example, if I had a report template that included the creation date as part of the front page then I might have a token like this:
  `%%creation_date%%`

Then I would have code which takes structured data from whatever source - a simulation, ChatGPT, etc. - and have that parse out token replacements like this:
    
    replacements = [
        replacement_template(
            token='%%creation_date%%', 
            new_value=datetime.datetime.utcnow().isoformat()
        )
    ]

Google's API batchUpdate method requires a list of dicts for the replacement text. The function `replacement_template` is in the files.py file. With each token that needs replacing you do something like this:

    replacements.append(
        replacement_template(
            token=<token that exists in template doc>, 
            new_value=<item specific to this report instance>
        )
    )

## API Credentials
If you are not already familiar with Google's API then you should read this page:
https://developers.google.com/docs/api/quickstart/python

It not only gives you a basic idea of how the Google API works (and what this repo leverages) but it also provides instructions on how to get your account setup to use this tool. You need to create an API key for both docs and drive. 